# 상담 예약 시스템 - 테스트 시나리오

## 테스트 계정

| 역할 | 이메일 | 비밀번호 |
|------|--------|----------|
| 상담사1 | counselor1@example.com | password123 |
| 상담사2 | counselor2@example.com | password123 |

---

## 테스트 순서

### 1단계: 상담사 로그인 (localhost:3000)

- [x] counselor1@example.com / password123 로 로그인
- [x] 로그인 성공 후 스케줄 관리 페이지로 이동 확인
- [x] 좌측 사이드바에 메뉴 표시 확인 (스케줄, 예약, 초대링크)

---

### 2단계: 스케줄 등록 (30분 단위, 스케줄당 최대 3명)

- [x] 캘린더에서 날짜 클릭 (예: 오늘 또는 내일)
- [x] "스케줄 추가" 버튼 클릭
- [x] 시간 선택 (예: 09:00) → 추가 → 자동으로 09:00~09:30 생성 확인
- [x] 같은 날짜에 2~3개 더 추가 (09:30, 10:00 등)
- [x] 캘린더에 해당 날짜 아래 파란 점 표시 확인
- [x] 스케줄 수정 테스트 (시간 변경)
- [x] 스케줄 삭제 테스트

---

### 3단계: 초대 링크 발송

- [x] 사이드바에서 "초대 링크" 메뉴 클릭
- [x] 이메일 입력 (본인 이메일 주소)
- [x] "초대 링크 발송" 클릭
- [x] 성공 메시지 확인: "초대 링크가 발송되었습니다"
- [x] 이메일 수신 확인 → 링크 클릭 또는 복사

> **참고**: SMTP 설정(.env)이 안 되어 있으면 발송 실패합니다.
> 이메일 없이 테스트하려면 Swagger(localhost:4000/api/docs)에서 직접 토큰을 생성하거나,
> DB에서 invitation_links 테이블의 token 값을 직접 확인하세요.

---

### 4단계: 신청자 예약 (localhost:3001)

#### 접속 방법
이메일 수신한 링크를 클릭하거나, 아래 형식으로 직접 접속:
```
http://localhost:3001/booking?token={토큰값}
```

#### 예약 플로우
- [x] 토큰이 포함된 URL로 접속
- [x] 상담사 이름 표시 확인
- [x] 캘린더에서 예약 가능 날짜 선택
- [x] 시간대 목록에서 시간 선택 (잔여 예약 수 표시 확인)
- [x] 신청자 정보 입력
  - [x] 이름: 테스트 신청자
  - [x] 이메일: test@example.com
  - [x] 연락처: 010-1234-5678 (선택)
- [x] "예약 신청" 클릭
- [x] 완료 페이지에서 예약 완료 메시지 및 예약 정보 요약 확인

---

### 5단계: 예약 확인 및 상담 기록 (localhost:3000)

- [x] 상담사 페이지에서 "예약 관리" 메뉴 클릭
- [x] 방금 등록된 예약이 목록에 표시되는지 확인
- [x] 상태 필터 조회 테스트 (전체/확정/완료/취소)
- [x] 스케줄 관리에서 해당 스케줄의 예약 카운트 증가 확인 (1/3명)
- [x] 예약 옆 "작성" 버튼 클릭 → 상담 내용 입력 → 저장
- [x] 저장 후 버튼이 "수정"으로 변경되는지 확인
- [x] "수정" 클릭 → 내용 수정 → 저장

---

### 6단계: 동시성 제한 테스트 (핵심)

> 스케줄당 최대 3명 제한이 정상 동작하는지 확인
> 초대 토큰이 여러 개 필요하므로, 3단계를 반복하여 초대 링크를 여러 개 발급합니다.

- [x] 같은 스케줄에 3번 예약 (서로 다른 이름/이메일, 각각 다른 초대 토큰 사용)
- [x] 3번째 예약까지 성공 확인
- [x] 4번째 예약 시도 → 마감 표시로 선택 불가 확인
- [x] 신청자 페이지에서 해당 시간이 선택 불가 표시 확인

---

### 7단계: 에러 케이스

- [x] 잘못된 토큰으로 접속 → "유효하지 않은 링크" 페이지 확인
- [x] 토큰 없이 localhost:3001 접속 → 에러 페이지 확인
- [x] 상담사 페이지에서 로그아웃 후 직접 URL 접근 → 로그인 페이지 리다이렉트 확인

---

## 빠른 테스트 (최소 플로우)

1. **상담사 로그인** → counselor1@example.com / password123
2. **스케줄 추가** → 내일 09:00, 09:30, 10:00
3. **초대 링크 발송** → 본인 이메일로 발송 → 이메일에서 링크 확인
4. **신청자 접속** → 이메일 링크 클릭 또는 localhost:3001/booking?token={토큰}
5. **예약 신청** → 이름/이메일 입력 후 시간 선택 → 예약 완료 메시지 확인
6. **상담사 확인** → 예약 관리에서 예약 확인 → 상담 기록 작성
